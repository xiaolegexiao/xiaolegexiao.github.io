<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>肖了个肖的博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://http://xiaolegexiao.club/"/>
  <updated>2019-07-01T06:54:46.337Z</updated>
  <id>http://http://xiaolegexiao.club/</id>
  
  <author>
    <name>xiaolegexiao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>AWS搭建Shadowsocks</title>
    <link href="http://http://xiaolegexiao.club/2019/07/01/aws-ss/"/>
    <id>http://http://xiaolegexiao.club/2019/07/01/aws-ss/</id>
    <published>2019-07-01T05:55:02.000Z</published>
    <updated>2019-07-01T06:54:46.337Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Tips：必须要信用卡(可消费外币)</strong></p><p>1.<strong>注册AWS</strong><br>注册时需要填写信用卡会预授权付款1刀，并且注册时会通过电话方式发送验证码(中文)，要注意的是AWS免费每月750小时,如果你创建多个实例，那你每月的时长是多个实例的运行时间，千万不要超了。  </p><p>2.<strong>创建AWS实例</strong><br>1.<em>创建EC2实例</em><br><img src="/.com//1.png" alt="选择EC2实例"><br><img src="/.com//2.png" alt="启动EC2实例"><br><img src="/.com//3.png" alt="选择免费的AMI"><br><img src="/.com//4.png" alt="审核和启动"><br><img src="/.com//5.png" alt="选择创建新的密钥对，然后下载密钥对，将密钥对存储起来"><br><img src="/.com//6.png" alt="EC2实例已经创建完成">  </p><p>3.<strong>连接EC2实例</strong><br>这里使用Xshell进行连接，也可以使用<a href="https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/AccessingInstances.html" target="_blank" rel="noopener">官方方法</a>。<img src="/.com//7.png" alt="复制你EC2 IPv4公有IP，点击用户身份验证选择publicKey，导入之前保存的密钥对pem文件，用户名必须为ubuntu"></p><p>4.<strong>安装SS</strong>  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.获取系统root权限</span><br><span class="line">   sudo -s</span><br><span class="line"><span class="number">2</span>.更新apt-get</span><br><span class="line">  apt-get update</span><br><span class="line"><span class="number">3</span>.安装python包管理工具</span><br><span class="line">   apt-get install python-setuptools</span><br><span class="line">   apt-get install python-pip</span><br><span class="line"><span class="number">4</span>.安装shadowsocks</span><br><span class="line">   pip install shadowsocks</span><br><span class="line"><span class="number">5</span>.创建ss配置文件</span><br><span class="line">   mkdir /etc/shadowsocks</span><br><span class="line">   vim /etc/shadowsocks/ss.json</span><br><span class="line">   在打开的文件中按”i”键进入insert模式，然后输入</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="string">"server_port"</span>:<span class="number">443</span>,</span><br><span class="line">    <span class="string">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="string">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">    <span class="string">"password"</span>:<span class="string">"你要设置的密码"</span>,</span><br><span class="line">    <span class="string">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="string">"method"</span>:<span class="string">"aes-256-cfb"</span>,</span><br><span class="line">    <span class="string">"fast_open"</span>:<span class="keyword">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  按”ESC”退出Insert模式，再输入”:wq”保存退出配置文件。配置文件中的端口号和密码可以自行设置。</span><br></pre></td></tr></table></figure><p>5.<strong>启动SS</strong><br>    ssserver -c /etc/shadowsocks.json -d start<br>    如果错误：<br>   <code>Java  File “/usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py”, line 52, in load_openssllibcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,)File “/usr/lib/python2.7/ctypes/init.py”, line 375, in getattrfunc = self.getitem(name)File “/usr/lib/python2.7/ctypes/init.py”, line 380, in getitemfunc = self._FuncPtr((name_or_ordinal, self))AttributeError: /usr/lib/x86_64-Linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup    这是由于在 openssl1.1.0版本中，EVP_CIPHER_CTX_cleanup函数被替换为EVP_CIPHER_CTX_reset。    修改方法：1.用vim打开文件：vim /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py (该路径请根据自己的系统情况自行修改，如果不知道该文件在哪里的话，可以使用find命令查找文件位置)2.跳转到52行（shadowsocks2.8.2版本，其他版本搜索一下cleanup）3.进入编辑模式4.将第52行libcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,) 改为libcrypto.EVP_CIPHER_CTX_reset.argtypes = (c_void_p,)5.再次搜索cleanup（全文件共2处，此处位于111行），将libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) 改为libcrypto.EVP_CIPHER_CTX_reset(self._ctx)6.保存并退出7.启动shadowsocks服务：service shadowsocks start 或 sslocal -c ss配置文件目录8.问题解决</code>  </p><p>6.<strong>配置EC2实例入站规则</strong><br><img src="/.com//8.png" alt="入站规则"><br><img src="/.com//9.png" alt="添加入站规则"></p><p>7.<strong>SS客户端</strong><br><img src="/.com//10.png" alt="添加入站规则">  </p><p><strong>ps：右击任务栏右下角的小飞机图标，可以设置相应的属性项，包括开启自启，显示日志，PAC设置，系统代理模式等等。其中系统代理模式中的全局模式是指所有的请求都走代理（国内以及国外的），而PAC模式则是自动识别，国内的直连，国外的（例如Google，YouTube）走代理。</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Tips：必须要信用卡(可消费外币)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1.&lt;strong&gt;注册AWS&lt;/strong&gt;&lt;br&gt;注册时需要填写信用卡会预授权付款1刀，并且注册时会通过电话方式发送验证码(中文)，要注意的是AWS免费每月750小时,如果你创建多个
      
    
    </summary>
    
      <category term="AWS" scheme="http://http://xiaolegexiao.club/categories/AWS/"/>
    
    
      <category term="AWS SS" scheme="http://http://xiaolegexiao.club/tags/AWS-SS/"/>
    
  </entry>
  
</feed>
